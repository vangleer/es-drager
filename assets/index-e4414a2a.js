import{d as I,r as R,D as Z,o as f,c as w,E as re,e as F,t as q,G as se,_ as Y,h as M,n as A,z as h,l as t,w as d,i as E,F as $,a as H,u as l,H as le,b as L,I as ue,m as J,A as ee,J as N,K as X,C as j,s as Q,L as ie,M as P,N as ce,g as pe,O as me,P as fe,Q as ve,R as _e,S as ge,T as he,U as be,V as ye,W as we,X as Ve,Y as xe}from"./index-831a37bf.js";import{a as ke,d as Ce,G as Se,u as oe}from"./GridRect-93505f4b.js";import{u as ze,A as Me}from"./useArea-cf0a44d0.js";import{u as $e,$ as Ue,a as ne}from"./useEditorContainer-5bd0d090.js";const He=["fontSize","lineHeight","borderWidth","borderRadius"],ae=["fontSize","fontWeight","fontFamily","color","lineHeight","fontStyle","textDecoration","justifyContent","alignItems"];function K(v,e=!0){if(!v)return v;const m={},a=Object.keys(v).filter(n=>e?ae.includes(n):!ae.includes(n));for(const n of a)m[n]=He.includes(n)?ke(v[n]):v[n];return m}function Re(v,e){return Object.keys(v).reduce((m,a)=>(e.includes(a)||(m[a]=v[a]),m),{})}const Ee=["contenteditable"],De=I({__name:"TextEditor",props:{editable:{type:Boolean,default:!1},text:{type:String}},setup(v){const e=v,m=R();function a(){if(!m.value)return;const n=document.createRange();n.selectNode(m.value),window.getSelection().removeAllRanges(),window.getSelection().addRange(n)}return Z(()=>[e.editable],()=>{e.editable&&a()}),(n,_)=>(f(),w("div",{ref_key:"textRef",ref:m,class:se(["es-text",{editable:v.editable}]),contenteditable:v.editable},[re(n.$slots,"default",{},()=>[F(q(v.text),1)],!0)],10,Ee))}}),de=Y(De,[["__scopeId","data-v-6f7332e1"]]),Le='<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M938.666667 553.92V768c0 64.8-52.533333 117.333333-117.333334 117.333333H202.666667c-64.8 0-117.333333-52.533333-117.333334-117.333333V256c0-64.8 52.533333-117.333333 117.333334-117.333333h618.666666c64.8 0 117.333333 52.533333 117.333334 117.333333v297.92z m-64-74.624V256a53.333333 53.333333 0 0 0-53.333334-53.333333H202.666667a53.333333 53.333333 0 0 0-53.333334 53.333333v344.48A290.090667 290.090667 0 0 1 192 597.333333a286.88 286.88 0 0 1 183.296 65.845334C427.029333 528.384 556.906667 437.333333 704 437.333333c65.706667 0 126.997333 16.778667 170.666667 41.962667z m0 82.24c-5.333333-8.32-21.130667-21.653333-43.648-32.917333C796.768 511.488 753.045333 501.333333 704 501.333333c-121.770667 0-229.130667 76.266667-270.432 188.693334-2.730667 7.445333-7.402667 20.32-13.994667 38.581333-7.68 21.301333-34.453333 28.106667-51.370666 13.056-16.437333-14.634667-28.554667-25.066667-36.138667-31.146667A222.890667 222.890667 0 0 0 192 661.333333c-14.464 0-28.725333 1.365333-42.666667 4.053334V768a53.333333 53.333333 0 0 0 53.333334 53.333333h618.666666a53.333333 53.333333 0 0 0 53.333334-53.333333V561.525333zM320 480a96 96 0 1 1 0-192 96 96 0 0 1 0 192z m0-64a32 32 0 1 0 0-64 32 32 0 0 0 0 64z"></path></svg>',Ie='<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M896 896H96a32 32 0 0 1-32-32V224a32 32 0 0 1 64 0v608h768a32 32 0 1 1 0 64z"></path><path fill="currentColor" d="M247.008 640a32 32 0 0 1-20.992-56.192l200.992-174.24a32 32 0 0 1 42.272 0.288l172.128 153.44 229.088-246.304a32 32 0 0 1 46.88 43.616l-250.432 269.216a31.936 31.936 0 0 1-44.704 2.08l-174.56-155.52-179.744 155.84a31.872 31.872 0 0 1-20.928 7.776z"></path></svg>',Te='<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M512 928C282.624 928 96 741.376 96 512S282.624 96 512 96s416 186.624 416 416-186.624 416-416 416z m0-768C317.92 160 160 317.92 160 512s157.92 352 352 352 352-157.92 352-352S706.08 160 512 160z"></path></svg>',Ae='<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M821.816 328.808H203.12c-49.072 0-88.192 33.656-88.192 74.6V701.52c0 41.504 39.792 74.6 88.192 74.6h618.688c49.072 0 88.184-33.656 88.184-74.6V403.408c0.008-40.944-39.784-74.6-88.176-74.6z m-1.96 423.496H203.76c-68.36 0-61.888-59.064-61.888-133.152v-131.68c0-73.096-6.472-133.16 61.888-133.16h616.104c68.328 0 61.88 60.064 61.88 133.16v131.688c0 73.064 6.44 133.144-61.888 133.144z"></path><path fill="currentColor" d="M693.784 460.728H329.816c-40.384 0-36.56 27.696-36.56 61.384v60.72c0 34.144-3.824 61.376 36.56 61.376h363.968c40.384 0 36.576-27.688 36.576-61.376v-60.72c0-33.688 3.808-61.384-36.576-61.384z"></path></svg>',Be='<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M853.333333 138.666667H170.666667c-17.066667 0-32 14.933333-32 32v128c0 17.066667 14.933333 32 32 32s32-14.933333 32-32V202.666667h277.333333v618.666666H384c-17.066667 0-32 14.933333-32 32s14.933333 32 32 32h256c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32h-96v-618.666666h277.333333V298.666667c0 17.066667 14.933333 32 32 32s32-14.933333 32-32V170.666667c0-17.066667-14.933333-32-32-32z"></path></svg>',Oe='<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M864 896H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h704a32 32 0 0 1 32 32v704a32 32 0 0 1-32 32zM192 832h640V192H192v640z"></path></svg>',Pe=Object.assign({"./svg/图片.svg":Le,"./svg/图表.svg":Ie,"./svg/圆形.svg":Te,"./svg/按钮.svg":Ae,"./svg/文本.svg":Be,"./svg/矩形.svg":Oe}),Ne={name:String,color:String,size:[String,Number]},We=v=>v?Pe[`./svg/${v}.svg`]:"",je=["innerHTML"],Ye=I({__name:"Icon",props:Ne,setup(v){const e=v,m=M(()=>We(e.name)),a=M(()=>!e.size&&!e.color?{}:{fontSize:typeof e.size=="string"?e.size:`${e.size}px`,"--color":e.color});return(n,_)=>(f(),w("i",{class:"es-icon",style:A(a.value),innerHTML:m.value},null,12,je))}}),Ge=Y(Ye,[["__scopeId","data-v-41413139"]]),Fe={class:"es-layout-aside"},qe={class:"collapse-content"},Xe=["onDragstart"],Je={class:"block-text"},Ke={class:"collapse-content"},Qe=["onDragstart"],Ze=I({__name:"Aside",emits:["dragstart","dragend"],setup(v,{emit:e}){const m=e,a=R(["1","2"]);function n(p,s){let o=50,c=50;s.component!=="es-icon"&&(o=s.width||p.target.offsetWidth,c=s.height||p.target.offsetHeight),m("dragstart",{...s,width:o,height:c})}function _(){m("dragend")}return(p,s)=>{const o=h("el-collapse-item"),c=h("el-collapse");return f(),w("div",Fe,[re(p.$slots,"default",{},()=>[t(c,{modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=r=>a.value=r)},{default:d(()=>[t(o,{title:"通用",name:"1"},{default:d(()=>[E("div",qe,[(f(!0),w($,null,H(l(le).componentList,r=>(f(),w("div",{class:"es-block",draggable:"true",onDragstart:b=>n(b,r),onDragend:_},[t(Ge,{name:r.text},null,8,["name"]),E("span",Je,q(r.text),1)],40,Xe))),256))])]),_:1}),t(o,{title:"图标",name:"2"},{default:d(()=>[E("div",Ke,[(f(!0),w($,null,H(l(le).iconList,r=>(f(),w("div",{class:"es-block",draggable:"true",onDragstart:b=>n(b,r),onDragend:_},[r.component?(f(),L(ee(r.component),ue(J({key:0},r.props)),null,16)):(f(),w($,{key:1},[F(q(r.props.icon),1)],64))],40,Qe))),256))])]),_:1})]),_:1},8,["modelValue"])])])}}}),et=I({__name:"EditorStyle",setup(v){const e=N(),m=R(100),a=M({get:()=>{const{width:p,height:s}=e.data.container.style;return`${p} x ${s}`},set:p=>{const[s,o]=p.split(" x ");e.data.container.style.width=+s,e.data.container.style.height=+o}}),n=[{label:"PC",options:[{label:"1360 x 760",value:"1360 x 760"},{label:"1280 x 720",value:"1280 x 720"},{label:"800 x 600",value:"800 x 600"}]},{label:"H5",options:[{label:"360 x 780",value:"360 x 780"},{label:"iPhone 6/7/8",value:"375 x 667"},{label:"iPhone 6/7/8 Plus",value:"414 x 736"}]}],_=p=>{e.data.container.scaleRatio=p/100};return(p,s)=>{const o=h("el-option"),c=h("el-option-group"),r=h("el-select"),b=h("el-form-item"),z=h("el-input"),g=h("el-input-number"),k=h("el-switch"),B=h("el-color-picker"),y=h("el-checkbox"),S=h("el-form");return f(),L(S,{model:l(e).data.container,"label-width":"90px","label-position":"left",style:{padding:"0 10px"}},{default:d(()=>[t(b,{label:"画布尺寸"},{default:d(()=>[t(r,{modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=u=>a.value=u)},{default:d(()=>[(f(),w($,null,H(n,u=>t(c,{key:u.label,label:u.label},{default:d(()=>[(f(!0),w($,null,H(u.options,i=>(f(),L(o,{label:i.label,value:i.value},null,8,["label","value"]))),256))]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),t(b,{label:"缩放比例(%)"},{default:d(()=>[t(z,{modelValue:m.value,"onUpdate:modelValue":s[1]||(s[1]=u=>m.value=u),modelModifiers:{number:!0},onChange:_},null,8,["modelValue"])]),_:1}),t(b,{label:"画布宽度"},{default:d(()=>[t(g,{modelValue:l(e).data.container.style.width,"onUpdate:modelValue":s[2]||(s[2]=u=>l(e).data.container.style.width=u)},null,8,["modelValue"])]),_:1}),t(b,{label:"画布高度"},{default:d(()=>[t(g,{modelValue:l(e).data.container.style.height,"onUpdate:modelValue":s[3]||(s[3]=u=>l(e).data.container.style.height=u)},null,8,["modelValue"])]),_:1}),t(b,{label:"网格"},{default:d(()=>[t(k,{modelValue:l(e).data.container.snapToGrid,"onUpdate:modelValue":s[4]||(s[4]=u=>l(e).data.container.snapToGrid=u)},null,8,["modelValue"])]),_:1}),t(b,{label:"网格大小"},{default:d(()=>[t(g,{modelValue:l(e).data.container.gridSize,"onUpdate:modelValue":s[5]||(s[5]=u=>l(e).data.container.gridSize=u)},null,8,["modelValue"])]),_:1}),t(b,{label:"网格颜色"},{default:d(()=>[t(B,{modelValue:l(e).data.container.gridColor,"onUpdate:modelValue":s[6]||(s[6]=u=>l(e).data.container.gridColor=u)},null,8,["modelValue"])]),_:1}),t(b,{label:"背景颜色"},{default:d(()=>[t(B,{modelValue:l(e).data.container.style.backgroundColor,"onUpdate:modelValue":s[7]||(s[7]=u=>l(e).data.container.style.backgroundColor=u)},null,8,["modelValue"])]),_:1}),t(b,{label:"参考线"},{default:d(()=>[t(y,{modelValue:l(e).data.container.markline.show,"onUpdate:modelValue":s[8]||(s[8]=u=>l(e).data.container.markline.show=u)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])}}}),tt='<svg t="1692778133849" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="15222" width="16" height="16"><path d="M123.26 411.37a32 32 0 1 1 45.28-45.23l311.34 311.67L479.71 97a32 32 0 0 1 32-32 32 32 0 0 1 32 32l0.17 580.89 311.59-311.76a32 32 0 0 1 45.27 45.24l-366.2 366.39-0.19 0.18-0.94 0.9-0.52 0.44-0.62 0.53-0.1 0.09-0.62 0.47-0.5 0.4c-0.05 0-0.1 0.08-0.16 0.11-0.21 0.16-0.43 0.31-0.65 0.46l-0.46 0.32-0.2 0.14-0.65 0.41-0.48 0.29a1.64 1.64 0 0 1-0.22 0.14l-0.62 0.35-0.52 0.29-0.23 0.13-0.59 0.29-0.6 0.3-0.18 0.09c-0.17 0.09-0.35 0.16-0.53 0.24l-0.71 0.3-0.19 0.08-0.48 0.18c-0.27 0.1-0.54 0.21-0.81 0.3H522.6l-0.42 0.13-0.91 0.3h-0.14l-0.39 0.11-1 0.26h-0.12l-0.38 0.08c-0.34 0.08-0.68 0.16-1 0.22h-0.06l-0.42 0.07-1 0.17h-0.09c-0.17 0-0.34 0-0.51 0.06l-0.94 0.12h-0.95l-0.75 0.05h-3.12l-0.75-0.05H508.84l-0.94-0.12c-0.17 0-0.34 0-0.51-0.06h-0.09l-1-0.17-0.42-0.07h-0.1c-0.34-0.06-0.68-0.14-1-0.22l-0.4-0.08h-0.08l-1-0.26-0.4-0.11h-0.14l-0.89-0.29-0.45-0.14-0.14-0.05c-0.26-0.09-0.53-0.19-0.79-0.3l-0.49-0.18h-0.2l-0.69-0.3-0.55-0.24-0.18-0.09-0.59-0.3-0.6-0.29-0.17-0.09h-0.05l-0.52-0.28-0.64-0.36-0.14-0.09h-0.07l-0.47-0.3c-0.22-0.14-0.45-0.27-0.67-0.42h-0.07l-0.11-0.08-0.47-0.33-0.81-0.49-0.09-0.08-0.53-0.42-0.61-0.47-0.08-0.07c-0.24-0.19-0.47-0.4-0.7-0.6l-0.46-0.4c-0.41-0.37-0.81-0.74-1.19-1.13zM896.68 895H127.32a32 32 0 1 0 0 64h769.36a32 32 0 0 0 0-64z" fill="currentColor" p-id="15223"></path></svg>',lt='<svg t="1692774315617" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8893" width="16" height="16"><path fill="currentColor" d="M96 128h832v96H96zM96 576h832v96H96zM224 352h576v96H224zM224 800h576v96H224z" p-id="8894"></path></svg>',ot='<svg t="1692774266304" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6910" width="16" height="16"><path fill="currentColor" d="M96 128h832v96H96zM96 576h832v96H96zM96 352h576v96H96zM96 800h576v96H96z" p-id="6911"></path></svg>',nt='<svg t="1692778640543" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7435" width="16" height="16"><path fill="currentColor" d="M143.998942-0.011289h64.007055V1024h-64.007055zM815.982714 224.002117h64.007056v575.984478h-64.007056zM591.991886-0.011289h64.007056V1024h-64.007056zM368.001058 224.002117h63.995767v575.984478h-63.995767z" p-id="7436"></path></svg>',at='<svg t="1692774301684" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7896" width="16" height="16"><path fill="currentColor" d="M96 128h832v96H96zM96 576h832v96H96zM352 352h576v96H352zM352 800h576v96H352z" p-id="7897"></path></svg>',rt='<svg t="1692777879594" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="14228" width="16" height="16"><path d="M557.654996 981.669904c-6.499999 59.041994-88.986991 53.776995-92.179991 0-0.083-40.896996-0.083-641.390937-0.083-641.390937l-283.839972 273.963973c-44.472996 38.308996-97.43499-22.922998-64.344994-63.215994 125.709988-121.895988 351.289966-340.004967 356.507965-345.049966 20.810998-22.608998 53.572995-23.779998 75.721993 0 41.406996 40.037996 348.700966 336.328967 358.028965 346.989966 31.166997 38.741996-19.223998 96.073991-62.242994 63.773994C834.109969 607.310941 557.739996 340.267967 557.739996 340.267967M116.396039 3.332l786.487923 0 0 89.285991L116.396039 92.617991 116.396039 3.332z" fill="currentColor" p-id="14229"></path></svg>',st=Object.assign({"./bottom.svg":tt,"./center.svg":lt,"./left.svg":ot,"./middle.svg":nt,"./right.svg":at,"./top.svg":rt}),G=v=>v?st[`./${v}.svg`]:"",dt={class:"text-block-box"},ut={class:"text-style-block"},it=["onClick","innerHTML"],ct=I({__name:"TextStyle",setup(v){const e=N(),m=[{label:"正常",value:"normal"},{label:"标题 1",value:"2em"},{label:"标题 2",value:"1.5em"},{label:"标题 3",value:"1.17em"},{label:"标题 4",value:"1em"},{label:"标题 5",value:"0.9em"},{label:"标题 6",value:"0.8em"}],a=R(""),n=[{label:"B",key:"fontWeight",value:"bold"},{label:"I",key:"fontStyle",value:"italic"},{label:"U",key:"textDecoration",value:"underline"},{label:"S",key:"textDecoration",value:"line-through"},{label:G("left"),key:"justifyContent",value:"flex-start"},{label:G("center"),key:"justifyContent",value:"center"},{label:G("right"),key:"justifyContent",value:"flex-end"},{label:G("top"),key:"alignItems",value:"flex-start"},{label:G("middle"),key:"alignItems",value:"center"},{label:G("bottom"),key:"alignItems",value:"flex-end"}],_=M(()=>[...n].map(g=>({...g,selected:z(g.key)===g.value}))),p=M(()=>[_.value.slice(0,4),_.value.slice(4,7),_.value.slice(7,10)]),s=[{label:"Helvetica"},{label:"PingFang SC"},{label:"Hiragino Sans GB"},{label:"Microsoft YaHei"},{label:"Times New Roman"},{label:"Verdana"},{label:"Courier New"},{label:"Georgia"},{label:"Lucida Sans"},{label:"Tahoma"}];function o(g){g.selected=!g.selected,b(g.key,g.selected?g.value:void 0)}function c(g){const k=g==="normal";e.current.style.fontSize=k?void 0:g,e.current.style.fontWeight=k?"normal":"bold"}const r=M({get:()=>e.current.style||{},set:g=>{e.current.style=e.current.style||{},Object.keys(g).forEach(k=>{b(k,g[k])})}});function b(g,k){e.current.style[g]=k}function z(g){return e.current.style[g]}return(g,k)=>{const B=h("el-color-picker"),y=h("el-form-item"),S=h("el-option"),u=h("el-select"),i=h("el-input"),T=h("el-input-number");return f(),w("div",null,[t(y,{label:"字体颜色"},{default:d(()=>[t(B,{modelValue:r.value.color,"onUpdate:modelValue":k[0]||(k[0]=x=>r.value.color=x)},null,8,["modelValue"])]),_:1}),t(y,{label:"标题"},{default:d(()=>[t(u,{modelValue:a.value,"onUpdate:modelValue":k[1]||(k[1]=x=>a.value=x),placeholder:"标题",onChange:c},{default:d(()=>[(f(),w($,null,H(m,x=>t(S,{label:x.label,value:x.value},{default:d(()=>[E("span",{style:A({fontSize:x.value,fontWeight:"bold"})},q(x.label),5)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(y,{label:"字体"},{default:d(()=>[t(u,{modelValue:r.value.fontFamily,"onUpdate:modelValue":k[2]||(k[2]=x=>r.value.fontFamily=x),placeholder:"字体"},{default:d(()=>[(f(),w($,null,H(s,x=>t(S,{label:x.label,value:x.label},{default:d(()=>[E("span",{style:A({fontFamily:x.label})},q(x.label),5)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(y,{label:"字体大小"},{default:d(()=>[t(i,{modelValue:r.value.fontSize,"onUpdate:modelValue":k[3]||(k[3]=x=>r.value.fontSize=x)},null,8,["modelValue"])]),_:1}),t(y,{label:"行高"},{default:d(()=>[t(T,{modelValue:r.value.lineHeight,"onUpdate:modelValue":k[4]||(k[4]=x=>r.value.lineHeight=x)},null,8,["modelValue"])]),_:1}),t(y,{label:"文本"},{default:d(()=>[t(i,{type:"textarea",modelValue:l(e).current.text,"onUpdate:modelValue":k[5]||(k[5]=x=>l(e).current.text=x)},null,8,["modelValue"])]),_:1}),E("div",dt,[(f(!0),w($,null,H(p.value,(x,W)=>(f(),w("div",ut,[(f(!0),w($,null,H(x,D=>(f(),w("div",{style:A(W===0?{[D.key]:D.value}:{}),class:se(["block-item",{active:D.selected}]),onClick:C=>o(D),innerHTML:D.label},null,14,it))),256))]))),256))])])}}}),pt=Y(ct,[["__scopeId","data-v-f8236b34"]]),mt={class:"info-color-map"},ft={class:"color-list"},vt=["onClick"],_t=I({__name:"ElementStyle",setup(v){const e=N(),m=R(["style"]),a=R([[{backgroundColor:"#18141d",borderColor:"#ffffff"},{backgroundColor:"#f5f5f5",borderColor:"#666666"},{backgroundColor:"#dae8fc",borderColor:"#6b8ebf"},{backgroundColor:"#d5e8d4",borderColor:"#82b366"},{backgroundColor:"#ffe6cc",borderColor:"#d79b00"},{backgroundColor:"#fff2cc",borderColor:"#d6b656"},{backgroundColor:"#f8cecc",borderColor:"#b85450"},{backgroundColor:"#e1d5e7",borderColor:"#9673a6"}]]),n=[{label:"实线",value:"solid"},{label:"虚线",value:"dashed"},{label:"点线",value:"dotted"}],_=s=>{e.current.selected&&(e.current.style={...e.current.style,...s})};function p(s,o){e.current.style[s]=o}return(s,o)=>{const c=h("el-input-number"),r=h("el-form-item"),b=h("el-color-picker"),z=h("el-checkbox"),g=h("el-slider"),k=h("el-option"),B=h("el-select"),y=h("el-collapse-item"),S=h("el-collapse"),u=h("el-form");return l(e).current&&l(e).current.selected?(f(),L(u,{key:0,model:l(e).current,"label-width":"80px","label-position":"left"},{default:d(()=>[t(S,{modelValue:m.value,"onUpdate:modelValue":o[15]||(o[15]=i=>m.value=i)},{default:d(()=>[t(y,{title:"布局/样式",name:"style"},{default:d(()=>[E("div",mt,[(f(!0),w($,null,H(a.value,i=>(f(),w("div",ft,[(f(!0),w($,null,H(i,T=>(f(),w("div",{class:"color-item",style:A(T),onClick:x=>_(T)},null,12,vt))),256))]))),256))]),t(r,{label:"left"},{default:d(()=>[t(c,{modelValue:l(e).current.left,"onUpdate:modelValue":o[0]||(o[0]=i=>l(e).current.left=i)},null,8,["modelValue"])]),_:1}),t(r,{label:"top"},{default:d(()=>[t(c,{modelValue:l(e).current.top,"onUpdate:modelValue":o[1]||(o[1]=i=>l(e).current.top=i)},null,8,["modelValue"])]),_:1}),t(r,{label:"width"},{default:d(()=>[t(c,{modelValue:l(e).current.width,"onUpdate:modelValue":o[2]||(o[2]=i=>l(e).current.width=i)},null,8,["modelValue"])]),_:1}),t(r,{label:"height"},{default:d(()=>[t(c,{modelValue:l(e).current.height,"onUpdate:modelValue":o[3]||(o[3]=i=>l(e).current.height=i)},null,8,["modelValue"])]),_:1}),t(r,{label:"angle"},{default:d(()=>[t(c,{modelValue:l(e).current.angle,"onUpdate:modelValue":o[4]||(o[4]=i=>l(e).current.angle=i)},null,8,["modelValue"])]),_:1}),t(r,{label:"color"},{default:d(()=>[t(b,{modelValue:l(e).current.color,"onUpdate:modelValue":o[5]||(o[5]=i=>l(e).current.color=i)},null,8,["modelValue"])]),_:1}),t(r,{label:"disabled"},{default:d(()=>[t(z,{modelValue:l(e).current.disabled,"onUpdate:modelValue":o[6]||(o[6]=i=>l(e).current.disabled=i)},null,8,["modelValue"])]),_:1}),t(r,{label:"resizable"},{default:d(()=>[t(z,{modelValue:l(e).current.resizable,"onUpdate:modelValue":o[7]||(o[7]=i=>l(e).current.resizable=i),checked:!0},null,8,["modelValue"])]),_:1}),t(r,{label:"rotatable"},{default:d(()=>[t(z,{modelValue:l(e).current.rotatable,"onUpdate:modelValue":o[8]||(o[8]=i=>l(e).current.rotatable=i),checked:!0},null,8,["modelValue"])]),_:1}),t(r,{label:"透明度"},{default:d(()=>[t(g,{modelValue:1,step:.01,min:0,max:1,onInput:o[9]||(o[9]=i=>p("opacity",i))})]),_:1}),l(e).current.style?(f(),w($,{key:0},[t(r,{label:"背景颜色"},{default:d(()=>[t(b,{modelValue:l(e).current.style.backgroundColor,"onUpdate:modelValue":o[10]||(o[10]=i=>l(e).current.style.backgroundColor=i)},null,8,["modelValue"])]),_:1}),t(r,{label:"边框颜色"},{default:d(()=>[t(b,{modelValue:l(e).current.style.borderColor,"onUpdate:modelValue":o[11]||(o[11]=i=>l(e).current.style.borderColor=i)},null,8,["modelValue"])]),_:1}),t(r,{label:"边框宽度"},{default:d(()=>[t(c,{modelValue:l(e).current.style.borderWidth,"onUpdate:modelValue":o[12]||(o[12]=i=>l(e).current.style.borderWidth=i)},null,8,["modelValue"])]),_:1}),t(r,{label:"边框风格"},{default:d(()=>[t(B,{modelValue:l(e).current.style.borderStyle,"onUpdate:modelValue":o[13]||(o[13]=i=>l(e).current.style.borderStyle=i)},{default:d(()=>[(f(),w($,null,H(n,i=>t(k,{key:i.value,label:i.label,value:i.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(r,{label:"边框半径"},{default:d(()=>[t(c,{modelValue:l(e).current.style.borderRadius,"onUpdate:modelValue":o[14]||(o[14]=i=>l(e).current.style.borderRadius=i)},null,8,["modelValue"])]),_:1})],64)):X("",!0)]),_:1}),t(y,{title:"文本",name:"text"},{default:d(()=>[t(pt)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model"])):X("",!0)}}}),gt=Y(_t,[["__scopeId","data-v-29ac4c7a"]]),ht=I({__name:"Style",setup(v){const e=N();return(m,a)=>(f(),w("div",{class:"es-info-style",onClick:a[0]||(a[0]=j(()=>{},["stop"]))},[l(e).current&&l(e).current.selected?(f(),L(gt,{key:0})):(f(),L(et,{key:1}))]))}}),bt={class:"es-layout-info"},yt=I({__name:"Info",setup(v){const e=N(),m=M(()=>e.current&&e.current.selected?"元素属性":"画布属性"),a=R("style"),n=(_,p)=>{console.log(_,p)};return(_,p)=>{const s=h("el-tab-pane"),o=h("el-tabs");return f(),w("div",bt,[t(o,{modelValue:a.value,"onUpdate:modelValue":p[0]||(p[0]=c=>a.value=c),class:"es-info-tabs",onTabClick:n},{default:d(()=>[t(s,{label:m.value,name:"style"},{default:d(()=>[t(ht)]),_:1},8,["label"])]),_:1},8,["modelValue"])])}}});function wt(v){const e={current:-1,queue:[],commands:{},commandArray:[],destoryArray:[]},m=n=>{e.commandArray.push(n),e.commands[n.name]=(..._)=>{const{redo:p,undo:s}=n.execute(..._);if(p&&p(),n.pushQueue){let{queue:o}=e;o.length>0&&(o=o.slice(0,e.current+1),e.queue=o),e.queue.push({redo:p,undo:s}),e.current+=1}}};m({name:"redo",keyboard:"ctrl+y",execute(){return{redo(){let n=e.queue[e.current+1];n&&(n.redo&&n.redo(),e.current++)}}}}),m({name:"undo",keyboard:"ctrl+z",execute(){return{redo(){if(e.current===-1)return;let n=e.queue[e.current];n&&(n.undo&&n.undo(),e.current--)}}}}),m({name:"drag",pushQueue:!0,init(){const n=()=>{this.before=Ce(v.data.elements)},_=()=>e.commands.drag();return P.on("dragstart",n),P.on("dragend",_),()=>{P.off("dragstart",n),P.off("dragend",_)}},execute(){const n=this.before,_=v.data.elements;return{redo(){v.data={...v.data,elements:_}},undo(){v.data={...v.data,elements:n}}}}}),m({name:"updateContainer",pushQueue:!0,execute(n){const _={before:v.data,after:n};return{redo(){v.data=_.after},undo(){v.data=_.before}}}}),e.commandArray.forEach(n=>{n.init&&e.destoryArray.push(n.init())});const a=()=>{const n=_=>{const{ctrlKey:p,key:s}=_,o=[];p&&o.push("ctrl"),o.push(s);const c=o.join("+");e.commandArray.forEach(({name:r,keyboard:b})=>{b&&b===c&&(e.commands[r](),_.preventDefault())})};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}};return Q(()=>{e.destoryArray.push(a())}),ie(()=>{e.destoryArray.forEach(n=>n&&n())}),e}const Vt=I({__name:"index",props:{modelValue:{type:Object,required:!0,default:()=>({})},commands:{type:Object}},setup(v){const e=N(),m=v,a=R(null),n=M({get:()=>m.modelValue,set:()=>{}}),_=M(()=>{var C;return((C=m.modelValue.container)==null?void 0:C.gridSize)||10}),p=M(()=>{var C;return((C=m.modelValue.container)==null?void 0:C.scaleRatio)||1}),s=M(()=>{const{width:C,height:U}=n.value.container.style;return{...n.value.container.style,width:C+"px",height:U+"px",transform:`scale(${p.value})`,transformOrigin:"top left"}}),o=R({startX:0,startY:0,disX:0,disY:0}),c=M({get:()=>e.current,set:C=>{e.current=C}}),r=R(),{areaSelected:b,onEditorMouseDown:z,onAreaMove:g,onAreaUp:k}=ze(n,r),{editorRect:B,onContextmenu:y,onEditorContextMenu:S}=$e(n,a);function u(C){c.value=C,b.value||n.value.elements.filter(V=>V.selected).length===1&&n.value.elements.forEach(V=>V.selected=!1),c.value.selected=!0,o.value.startX=c.value.left,o.value.startY=c.value.top,P.emit("dragstart")}function i(){P.emit("dragend")}function T(C){const U=C.left-o.value.startX,V=C.top-o.value.startY;n.value.elements.forEach(O=>{var te;O.selected&&((te=c.value)==null?void 0:te.id)!==O.id&&(O.left+=U,O.top+=V)}),o.value.startX=C.left,o.value.startY=C.top}function x(C,U){Object.keys(C).forEach(V=>{U[V]=C[V]})}const W={dblclick:()=>{!c.value||!c.value.selected||(c.value.editable=!0)},click:()=>{c.value&&(c.value.editable=!1)}};function D(C="on"){["dblclick","click"].forEach(V=>{C==="on"?document.addEventListener(V,W[V]):document.removeEventListener(V,W[V])})}return Q(()=>{D()}),ce(()=>{D("off")}),(C,U)=>(f(),w("div",{ref_key:"editorRef",ref:a,class:"es-editor",style:A(s.value),onMousedown:U[2]||(U[2]=(...V)=>l(z)&&l(z)(...V)),onContextmenu:U[3]||(U[3]=j((...V)=>l(S)&&l(S)(...V),["prevent"]))},[(f(!0),w($,null,H(n.value.elements,V=>(f(),L(l(pe),J({rotatable:""},l(Re)(V,["style","props"]),{"grid-x":_.value,"grid-y":_.value,scaleRatio:p.value,boundary:"",markline:"",snap:"","snap-threshold":n.value.container.gridSize,onDragStart:O=>u(V),onDragEnd:i,onDrag:T,onChange:O=>x(O,V),onContextmenu:j(O=>l(y)(O,V),["stop"]),onMousedown:U[0]||(U[0]=j(()=>{},["stop"])),onClick:U[1]||(U[1]=j(()=>{},["stop"]))}),{default:d(()=>[(f(),L(ee(V.component),J({element:V},V.props,{style:{...l(K)(V.style,!1),width:"100%",height:"100%"}}),{default:d(()=>[V.text?(f(),L(de,{key:0,editable:V.editable,text:V.text,style:A(l(K)(V.style))},null,8,["editable","text","style"])):X("",!0)]),_:2},1040,["element","style"]))]),_:2},1040,["grid-x","grid-y","scaleRatio","snap-threshold","onDragStart","onChange","onContextmenu"]))),256)),n.value.container.snapToGrid?(f(),L(Se,{key:0,grid:n.value.container.gridSize,"border-color":n.value.container.gridColor},null,8,["grid","border-color"])):X("",!0),t(Me,{ref_key:"areaRef",ref:r,onMove:l(g),onUp:l(k)},null,8,["onMove","onUp"])],36))}}),xt=Y(Vt,[["__scopeId","data-v-9e83b2c6"]]),kt={class:"es-preview-tools"},Ct=I({__name:"Preview",setup(v){const e=N(),m=R(),a=M(()=>{const{width:p,height:s}=e.data.container.style;return{...e.data.container.style,width:p+"px",height:s+"px",transform:`scale(${n.value})`,transformOrigin:"top left"}}),n=M(()=>{var p;return((p=e.data.container)==null?void 0:p.scaleRatio)||1});function _(p){const{width:s,height:o}=e.data.container.style,c=me().format("YYYY-MM-DD")+"-es-drager-editor."+p;fe(m.value).then(r=>{if(p==="pdf"){const b=new ve("l","pt","a4"),z=r.toDataURL();return b.addImage(z,"PNG",0,0,+s,+o),b.save(c)}r.toBlob(b=>{const z=document.createElement("a");z.download=c;const g=URL.createObjectURL(b);z.href=g,z.click(),URL.revokeObjectURL(g)})})}return(p,s)=>{const o=h("el-button"),c=h("el-dialog");return f(),L(c,{draggable:"",fullscreen:""},{default:d(()=>[E("div",kt,[t(o,{type:"primary",onClick:s[0]||(s[0]=r=>_("png"))},{default:d(()=>[F("导出PNG")]),_:1}),t(o,{type:"primary",onClick:s[1]||(s[1]=r=>_("jpg"))},{default:d(()=>[F("导出JPG")]),_:1}),t(o,{type:"primary",onClick:s[2]||(s[2]=r=>_("pdf"))},{default:d(()=>[F("导出PDF")]),_:1})]),E("div",{class:"es-preview-body",style:A({width:a.value.width,height:a.value.height})},[E("div",{ref_key:"editorRef",ref:m,class:"es-editor preview",style:A(a.value)},[(f(!0),w($,null,H(l(e).data.elements,r=>(f(),L(ee(r.component),J(r.props,{style:{...l(K)(r.style,!1),width:r.width+"px",height:r.height+"px",position:"absolute",left:r.left+"px",top:r.top+"px"}}),{default:d(()=>[r.text?(f(),L(de,{key:0,text:r.text,style:A(l(K)(r.style))},null,8,["text","style"])):X("",!0)]),_:2},1040,["style"]))),256))],4)],4)]),_:1})}}}),St=Y(Ct,[["__scopeId","data-v-294a182a"]]),zt={class:"es-layout-container"},Mt=I({__name:"index",props:{data:{type:Object,required:!0},theme:{type:String}},setup(v,{expose:e}){const m=v,a=N(),n=R(),{commands:_}=wt(a),p=[{label:"撤销",icon:_e,handler:_.undo},{label:"重做",icon:ge,handler:_.redo},{label:"导出",icon:he,handler:()=>{Ue({title:"导出",content:JSON.stringify(a.data),confirm(y){_.updateContainer(JSON.parse(y))}})}},{label:"导入",icon:be,handler:()=>{ne({resultType:"json",onChange(y){_.updateContainer(JSON.parse(y))}})}},{label:"插入图片",icon:ye,handler:()=>{ne({resultType:"image",onChange(y){const u={id:oe(),component:"img",props:{src:y,width:200,onLoadOnce(i){if(u.props.loaded)return;const{naturalHeight:T,naturalWidth:x}=i.target,W=a.data.elements.find(C=>C.id===u.id);let D=200/x;D>1&&(D=1),W.width=x*D,W.height=T*D,u.props.loaded=!0}}};a.data.elements.push(u)}})}},{label:"预览",icon:we,handler:()=>a.preview=!0}],s=M(()=>{const{width:y,height:S}=a.data.container.style,u={},i=a.initWidth>+y,T=a.initHeight>+S;return i&&(u.position="absolute",u.left="50%",u.transform="translateX(-50%)"),T&&(u.position="absolute",u.top="50%",u.transform="translateY(-50%)"),i&&T&&(u.transform="translate(-50%, -50%)"),u}),o=M(()=>{var y;return((y=n.value)==null?void 0:y.getBoundingClientRect())||{}});let c=null;function r(y){P.emit("dragstart"),c=y}function b(){P.emit("dragend")}function z(y){y.dataTransfer.dropEffect="move"}function g(y){if(!c)return;const S=c.component==="es-icon",u=[...a.data.elements,{...c,equalProportion:S,left:y.offsetX-c.width/2,top:y.offsetY-c.height/2,id:oe(),style:c.style||{}}];a.data.elements=u,c=null}function k(){a.initWidth=Math.floor(o.value.width),a.initHeight=Math.floor(o.value.height-7),a.data.container.style.width=a.initWidth,a.data.container.style.height=a.initHeight}function B(){return{...a.data}}return Z(()=>m.data,()=>{a.update(m.data)},{immediate:!0}),Z(()=>m.theme,()=>{m.theme&&(a.theme=m.theme)},{immediate:!0}),Q(()=>{k()}),e({tools:p,getData:B}),(y,S)=>(f(),w($,null,[E("div",zt,[t(Ze,{onDragstart:r,onDragend:b}),E("div",{ref_key:"mainRef",ref:n,class:"es-layout-main"},[E("div",{class:"es-editor-container",style:A(s.value)},[t(xt,{modelValue:l(a).data,"onUpdate:modelValue":S[0]||(S[0]=u=>l(a).data=u),commands:l(_),onDragenter:z,onDrop:g,onDragover:S[1]||(S[1]=j(()=>{},["prevent"]))},null,8,["modelValue","commands"])],4)],512),t(yt,{modelValue:l(a).current,"onUpdate:modelValue":S[2]||(S[2]=u=>l(a).current=u)},null,8,["modelValue"])]),t(St,{modelValue:l(a).preview,"onUpdate:modelValue":S[3]||(S[3]=u=>l(a).preview=u)},null,8,["modelValue"])],64))}}),$t={class:"es-header-toolbar"},Ut=["onClick"],Ht="ES Drager Editor 开发中...",Rt=I({__name:"index",setup(v){const e=R(null),m=Ve(),a=R({container:{markline:{show:!0,color:""},snapToGrid:!0,gridSize:10,gridColor:"",style:{},scaleRatio:1},elements:[{id:"1",component:"div",width:100,height:100,left:100,top:100,text:"div1",style:{border:"1px solid red",background:"blue"}},{id:"2",component:"div",width:100,height:100,left:300,top:150,text:"div2",style:{border:"1px solid red",background:"pink"}}]}),n=M(()=>{var p;return((p=e.value)==null?void 0:p.tools)||[]});function _(p){typeof p.handler=="function"&&p.handler()}return Q(()=>{console.log(e.value)}),(p,s)=>{const o=h("el-button");return f(),w("div",{class:"es-layout",onClick:s[0]||(s[0]=j(()=>{},["stop"]))},[t(xe,{title:Ht},{default:d(()=>[E("div",$t,[(f(!0),w($,null,H(n.value,c=>(f(),w("div",{class:"es-tool-btn",onClick:r=>_(c)},[t(o,{icon:c.icon},{default:d(()=>[F(q(c.label),1)]),_:2},1032,["icon"])],8,Ut))),256))])]),_:1}),t(l(Mt),{ref_key:"editorRef",ref:e,data:a.value,theme:l(m).theme},null,8,["data","theme"])])}}});const Tt=Y(Rt,[["__scopeId","data-v-317a2fe5"]]);export{Tt as default};
