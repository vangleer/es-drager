import{d as E,r as x,s as B,j as A,B as L,o as y,c as S,y as b,_ as k}from"./index--VypQAbc.js";const C=E({__name:"Area",emits:["move","up"],setup(h,{expose:v,emit:r}){const m=r,p=x(!1),c=x({width:0,height:0,top:0,left:0}),f=B(()=>{const{width:e,height:t,top:o,left:n}=c.value;return{width:e+"px",height:t+"px",top:o+"px",left:n+"px"}});function M(e){const{pageX:t,pageY:o}=e,n=e.target.getBoundingClientRect(),s=t-n.left,i=o-n.top,l=d=>{const a=d.pageX-t,_=d.pageY-o;let X=s,Y=i,g=Math.abs(a),w=Math.abs(_);(g>2||w>2)&&(p.value=!0),a<0&&(X=s-g),_<0&&(Y=i-w),c.value={width:g,height:w,left:X,top:Y},m("move",{...c.value})},u=()=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",u),p.value=!1,c.value={width:0,height:0,top:0,left:0},m("up",c.value)};document.addEventListener("mousemove",l),document.addEventListener("mouseup",u)}return v({onMouseDown:M,areaData:c}),(e,t)=>A((y(),S("div",{class:"es-editor-area",style:b(f.value)},null,4)),[[L,p.value]])}}),R=k(C,[["__scopeId","data-v-0f3a726e"]]);function U(h,v){const r=x();function m(e){let t=!1;h.value.elements.forEach(o=>{o.selected&&(o.selected=!1,t=!0)}),t||v.value.onMouseDown(e)}function p(e){for(let t=0;t<h.value.elements.length;t++){const o=h.value.elements[t],n=c(o,o.angle||0),s=e.left<n.rotatedMinX&&e.left+e.width>n.rotatedMaxX&&e.top<n.rotatedMinY&&e.top+e.height>n.rotatedMaxY;o.selected=s}}function c(e,t){const o=e.left+e.width/2,n=e.top+e.height/2,s=[f(e.left,e.top,o,n,t),f(e.left+e.width,e.top,o,n,t),f(e.left,e.top+e.height,o,n,t),f(e.left+e.width,e.top+e.height,o,n,t)],i=Math.min(...s.map(a=>a[0])),l=Math.max(...s.map(a=>a[0])),u=Math.min(...s.map(a=>a[1])),d=Math.max(...s.map(a=>a[1]));return{rotatedMinX:i,rotatedMaxX:l,rotatedMinY:u,rotatedMaxY:d}}function f(e,t,o,n,s){const i=s*Math.PI/180,l=e-o,u=t-n;return[l*Math.cos(i)-u*Math.sin(i)+o,l*Math.sin(i)+u*Math.cos(i)+n]}function M(){r.value=h.value.elements.some(e=>e.selected),r.value&&setTimeout(()=>{document.addEventListener("click",()=>{r.value=!1},{once:!0})})}return{areaSelected:r,onEditorMouseDown:m,onAreaMove:p,onAreaUp:M}}export{R as A,U as u};
