import{G as F}from"./GridRect-e7b7002b.js";import{d as G}from"./index.es-0dd7c7ce.js";import{M as I}from"./MarkLine-a8396511.js";import{d as J,r as _,eF as K,eG as O,eH as P,o as d,c as k,h as L,k as u,w as p,e as v,t as g,u as l,f as x,F as V,a as z,b as w,eI as R,m as T,eJ as j,eK as q,eL as H,_ as U}from"./index-3c88ecf2.js";const $={class:"es-container"},A={class:"es-tools"},Q={class:"es-editor"},W=J({__name:"markline",setup(X){const C=_(-1),c=_({componentList:[{id:"div1",component:"div",text:"div1",width:100,height:100,left:0,top:0},{id:"div2",component:"div",text:"div2",width:100,height:100,top:100,left:100}]}),s=K({left:null,top:null}),r=_({x:[],y:[]}),f=N(c);function b(t){C.value=t,r.value=H(c.value.componentList,c.value.componentList[t])}function D(t){s.top=null,s.left=null;for(let e=0;e<r.value.y.length;e++){const{top:o,showTop:n}=r.value.y[e];if(Math.abs(o-t.top)<5){s.top=n;break}}for(let e=0;e<r.value.x.length;e++){const{left:o,showLeft:n}=r.value.x[e];if(Math.abs(o-t.left)<5){s.left=n;break}}}function B(){f.record(),s.top=null,s.left=null}function E(t,e){Object.keys(t).forEach(o=>{e[o]=t[o]})}function N(t){const e=[];let o=-1;const n=()=>{console.log("redo",o,e),o<e.length-1&&(o++,t.value.componentList=m(e[o]))},i=()=>{console.log("undo",o,e),o>=0&&(o--,e[o]&&(t.value.componentList=m(e[o])))},a=()=>{e[++o]=m(t.value.componentList)};a();const h=S=>{const{ctrlKey:M,key:y}=S;M&&(y==="z"?i():y==="y"&&n())};return window.addEventListener("keydown",h),O(()=>{window.removeEventListener("keydown",h)}),{redo:n,undo:i,record:a}}function m(t){return JSON.parse(JSON.stringify(t))}return(t,e)=>{const o=P("el-button");return d(),k("div",$,[L("div",A,[u(o,{type:"primary",onClick:l(f).undo},{default:p(()=>[v(g(l(x)("examples.undo")),1)]),_:1},8,["onClick"]),u(o,{type:"primary",onClick:l(f).redo},{default:p(()=>[v(g(l(x)("examples.redo")),1)]),_:1},8,["onClick"])]),L("div",Q,[(d(!0),k(V,null,z(c.value.componentList,(n,i)=>(d(),w(l(G),T(n,{onDragStart:a=>b(i),onDrag:e[0]||(e[0]=a=>D(a)),onChange:a=>E(a,n),onDragEnd:B}),{default:p(()=>[(d(),w(R(n.component),null,{default:p(()=>[v(g(n.text),1)]),_:2},1024))]),_:2},1040,["onDragStart","onChange"]))),256)),u(I,j(q(s)),null,16),u(F,{class:"grid-rect"})])])}}});const te=U(W,[["__scopeId","data-v-6e7a462e"]]);export{te as default};
