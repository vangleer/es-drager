import{d as V,r as p,eO as j,b as f,e as L,g as x,B as u,i as d,t as m,F,j as I,h as w,s as O,x as y,v as U,k as E,u as P,_ as X}from"./index-c4559540.js";import{G as Y}from"./GridRect-a4b085e8.js";import{i as $}from"./index.es-b966b3a0.js";import{A as q}from"./Area-a4c01374.js";const z={class:"es-container"},H={class:"es-tools"},J=V({__name:"group",setup(K){const l=p({componentList:[{component:"div",text:"div1",width:100,height:100,left:100,top:100,style:{border:"1px solid #3a7afe"}},{component:"div",text:"div2",width:100,height:100,top:200,left:300,style:{border:"1px solid #3a7afe"}}]}),v=p(-1),h=p(),i=p(!1),r=p({prevLeft:0,prevTop:0});function M(e){i.value||l.value.componentList.forEach(t=>t.selected=!1);const o=l.value.componentList[e];o.selected=!0,r.value.prevLeft=o.left,r.value.prevTop=o.top,v.value=e}function k(e){const o=e.left-r.value.prevLeft,t=e.top-r.value.prevTop;l.value.componentList.forEach((n,s)=>{n.selected&&v.value!==s&&(n.left+=o,n.top+=t)}),r.value.prevLeft=e.left,r.value.prevTop=e.top}function C(e,o){Object.keys(e).forEach(t=>{o[t]=e[t]})}function T(e){let o=!1;l.value.componentList.forEach(t=>{t.selected&&(t.selected=!1,o=!0)}),o||h.value.onMouseDown(e)}function b(e){for(let o=0;o<l.value.componentList.length;o++){const t=l.value.componentList[o],n=e.left<t.left&&e.left+e.width>t.left+t.width,s=e.top<t.top&&e.top+e.height>t.top+t.height;n&&s?t.selected=!0:t.selected=!1}}function B(){i.value=l.value.componentList.some(e=>e.selected),i.value&&setTimeout(()=>{document.addEventListener("click",()=>{i.value=!1},{once:!0})})}function A(){const e=l.value.componentList.filter(a=>a.selected);if(!e.length)return;let{left:o,top:t}=e[0],n=o,s=t;Math.max(...e.map(a=>a.left)),e.slice(1).forEach(a=>{const{left:g,top:_,width:N,height:R}=a;o=Math.min(o,g),n=Math.max(n,g+N),t=Math.min(t,_),s=Math.max(s,_+R)}),e.forEach(a=>{a.left=a.left-o,a.top=a.top-t});const G={component:"es-group",group:!0,...{left:o,top:t,width:n-o,height:s-t},props:{elements:e}},S=l.value.componentList.filter(a=>!a.selected);l.value.componentList=[...S,G]}function D(){const e=l.value.componentList[v.value];if(!e||e.component!=="es-group")return;const t=e.props.elements.map(s=>({...s,selected:!1,left:s.left+e.left,top:s.top+e.top,angle:(s.angle||0)+(e.angle||0)})),n=l.value.componentList.filter(s=>s!==e);l.value.componentList=[...n,...t]}return(e,o)=>{const t=j("el-button");return f(),L("div",z,[x("div",H,[u(t,{type:"primary",onClick:A},{default:d(()=>[m("组合")]),_:1}),u(t,{type:"primary",onClick:D},{default:d(()=>[m("拆分")]),_:1})]),x("div",{class:"es-editor",onMousedown:T},[(f(!0),L(F,null,I(l.value.componentList,(n,s)=>(f(),w(P($),y(n,{onDragStart:c=>M(s),onDrag:o[0]||(o[0]=c=>k(c)),onChange:c=>C(c,n),onClick:o[1]||(o[1]=E(()=>{},["stop"])),onMousedown:o[2]||(o[2]=E(()=>{},["stop"]))}),{default:d(()=>[(f(),w(O(n.component),y(n.props,{style:{...n.style,width:"100%",height:"100%"}}),{default:d(()=>[m(U(n.text),1)]),_:2},1040,["style"]))]),_:2},1040,["onDragStart","onChange"]))),256)),u(Y),u(q,{ref_key:"areaRef",ref:h,onMove:b,onUp:B},null,512)],32)])}}});const te=X(J,[["__scopeId","data-v-948d89d2"]]);export{te as default};
